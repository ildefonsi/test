import React from 'react';
import {
  Box,
  Card,
  CardContent,
  Typography,
  Container,
  List,
  ListItem,
  ListItemIcon,
  ListItemText,
  Divider,
  Switch,
  FormControlLabel,
  Button,
  Grid,
  Paper,
} from '@mui/material';
import {
  Settings,
  Security,
  Notifications,
  Palette,
  Language,
  Backup,
  Info,
} from '@mui/icons-material';
  
import Chip from '@mui/material/Chip'; // <-- AÑADE ESTA LÍNEA  
  

const Configuracion = () => {
  const [notifications, setNotifications] = React.useState(true);
  const [darkMode, setDarkMode] = React.useState(true);
  const [autoBackup, setAutoBackup] = React.useState(false);

  const handleNotificationChange = (event) => {
    setNotifications(event.target.checked);
  };

  const handleDarkModeChange = (event) => {
    setDarkMode(event.target.checked);
  };

  const handleAutoBackupChange = (event) => {
    setAutoBackup(event.target.checked);
  };

  const configuraciones = [
    {
      categoria: 'Seguridad',
      icono: <Security />,
      items: [
        { nombre: 'Autenticación de dos factores', descripcion: 'Añade una capa extra de seguridad a tu cuenta' },
        { nombre: 'Historial de sesiones', descripcion: 'Revisa tus sesiones activas y cerradas' },
        { nombre: 'Contraseñas', descripcion: 'Cambia tu contraseña y gestiona recordatorios' },
      ],
    },
    {
      categoria: 'Notificaciones',
      icono: <Notifications />,
      items: [
        { nombre: 'Email', descripcion: 'Configura las notificaciones por correo electrónico' },
        { nombre: 'Push', descripcion: 'Gestiona las notificaciones push del navegador' },
        { nombre: 'SMS', descripcion: 'Configura las notificaciones por mensaje de texto' },
      ],
    },
    {
      categoria: 'Apariencia',
      icono: <Palette />,
      items: [
        { nombre: 'Tema', descripcion: 'Personaliza los colores y estilo de la interfaz' },
        { nombre: 'Idioma', descripcion: 'Selecciona tu idioma preferido' },
        { nombre: 'Tamaño de fuente', descripcion: 'Ajusta el tamaño del texto para mejor legibilidad' },
      ],
    },
    {
      categoria: 'Respaldo',
      icono: <Backup />,
      items: [
        { nombre: 'Exportar datos', descripcion: 'Descarga una copia de seguridad de tus datos' },
        { nombre: 'Importar datos', descripcion: 'Restaura datos desde una copia de seguridad' },
        { nombre: 'Sincronización', descripcion: 'Configura la sincronización automática' },
      ],
    },
  ];

  return (
    <Container maxWidth="lg" sx={{ mt: 4, mb: 4 }}>
      <Box sx={{ mb: 4 }}>
        <Typography variant="h4" component="h1" gutterBottom sx={{ fontWeight: 600 }}>
          Configuración
        </Typography>
        <Typography variant="body1" color="text.secondary">
          Personaliza tu experiencia en el sistema de gestión de usuarios.
        </Typography>
      </Box>

      <Grid container spacing={3}>
        {/* Configuraciones rápidas */}
        <Grid item xs={12} md={4}>
          <Card sx={{ backgroundColor: '#1e293b', border: '1px solid #334155', height: '100%' }}>
            <CardContent>
              <Typography variant="h6" gutterBottom sx={{ fontWeight: 600, mb: 3 }}>
                Configuraciones Rápidas
              </Typography>
              
              <Box sx={{ display: 'flex', flexDirection: 'column', gap: 3 }}>
                <FormControlLabel
                  control={
                    <Switch
                      checked={notifications}
                      onChange={handleNotificationChange}
                      color="primary"
                    />
                  }
                  label="Notificaciones"
                  sx={{ justifyContent: 'space-between', mx: 0 }}
                />
                
                <FormControlLabel
                  control={
                    <Switch
                      checked={darkMode}
                      onChange={handleDarkModeChange}
                      color="primary"
                    />
                  }
                  label="Modo Oscuro"
                  sx={{ justifyContent: 'space-between', mx: 0 }}
                />
                
                <FormControlLabel
                  control={
                    <Switch
                      checked={autoBackup}
                      onChange={handleAutoBackupChange}
                      color="primary"
                    />
                  }
                  label="Respaldo Automático"
                  sx={{ justifyContent: 'space-between', mx: 0 }}
                />
              </Box>

              <Box sx={{ mt: 4 }}>
                <Button
                  variant="contained"
                  fullWidth
                  sx={{ mb: 2 }}
                  startIcon={<Backup />}
                >
                  Realizar Respaldo Ahora
                </Button>
                <Button variant="outlined" fullWidth>
                  Restablecer Configuraciones
                </Button>
              </Box>
            </CardContent>
          </Card>
        </Grid>

        {/* Información del sistema */}
        <Grid item xs={12} md={4}>
          <Card sx={{ backgroundColor: '#1e293b', border: '1px solid #334155', height: '100%' }}>
            <CardContent>
              <Typography variant="h6" gutterBottom sx={{ fontWeight: 600, mb: 3 }}>
                Información del Sistema
              </Typography>
              
              <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2 }}>
                <Box sx={{ display: 'flex', justifyContent: 'space-between' }}>
                  <Typography variant="body2" color="text.secondary">
                    Versión
                  </Typography>
                  <Typography variant="body2" sx={{ fontWeight: 500 }}>
                    1.0.0
                  </Typography>
                </Box>
                
                <Box sx={{ display: 'flex', justifyContent: 'space-between' }}>
                  <Typography variant="body2" color="text.secondary">
                    Última Actualización
                  </Typography>
                  <Typography variant="body2" sx={{ fontWeight: 500 }}>
                    {new Date().toLocaleDateString()}
                  </Typography>
                </Box>
                
                <Box sx={{ display: 'flex', justifyContent: 'space-between' }}>
                  <Typography variant="body2" color="text.secondary">
                    Base de Datos
                  </Typography>
                  <Typography variant="body2" sx={{ fontWeight: 500 }}>
                    PostgreSQL
                  </Typography>
                </Box>
                
                <Box sx={{ display: 'flex', justifyContent: 'space-between' }}>
                  <Typography variant="body2" color="text.secondary">
                    Framework Backend
                  </Typography>
                  <Typography variant="body2" sx={{ fontWeight: 500 }}>
                    Spring Boot
                  </Typography>
                </Box>
                
                <Box sx={{ display: 'flex', justifyContent: 'space-between' }}>
                  <Typography variant="body2" color="text.secondary">
                    Framework Frontend
                  </Typography>
                  <Typography variant="body2" sx={{ fontWeight: 500 }}>
                    React
                  </Typography>
                </Box>
              </Box>

              <Box sx={{ mt: 4, pt: 2, borderTop: '1px solid #334155' }}>
                <Typography variant="body2" color="text.secondary" gutterBottom>
                  Tecnologías Utilizadas
                </Typography>
                <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 1 }}>
                  {['Java 17', 'Spring Boot', 'React', 'PostgreSQL', 'JWT', 'MyBatis'].map((tech) => (
                    <Chip
                      key={tech}
                      label={tech}
                      size="small"
                      variant="outlined"
                      sx={{ backgroundColor: 'rgba(59, 130, 246, 0.1)' }}
                    />
                  ))}
                </Box>
              </Box>
            </CardContent>
          </Card>
        </Grid>

        {/* Estadísticas de uso */}
        <Grid item xs={12} md={4}>
          <Card sx={{ backgroundColor: '#1e293b', border: '1px solid #334155', height: '100%' }}>
            <CardContent>
              <Typography variant="h6" gutterBottom sx={{ fontWeight: 600, mb: 3 }}>
                Estadísticas de Uso
              </Typography>
              
              <Box sx={{ display: 'flex', flexDirection: 'column', gap: 3 }}>
                <Box>
                  <Typography variant="body2" color="text.secondary" gutterBottom>
                    Espacio Utilizado
                  </Typography>
                  <Box sx={{ display: 'flex', alignItems: 'center', gap: 2 }}>
                    <Box sx={{ flexGrow: 1, backgroundColor: '#334155', borderRadius: 1, height: 8 }}>
                      <Box
                        sx={{
                          width: '65%',
                          height: '100%',
                          backgroundColor: '#3b82f6',
                          borderRadius: 1,
                        }}
                      />
                    </Box>
                    <Typography variant="body2" sx={{ fontWeight: 500 }}>
                      65%
                    </Typography>
                  </Box>
                </Box>
                
                <Box sx={{ display: 'flex', justifyContent: 'space-between' }}>
                  <Typography variant="body2" color="text.secondary">
                    Usuarios Activos
                  </Typography>
                  <Typography variant="body2" sx={{ fontWeight: 500 }}>
                    24
                  </Typography>
                </Box>
                
                <Box sx={{ display: 'flex', justifyContent: 'space-between' }}>
                  <Typography variant="body2" color="text.secondary">
                    Sesiones Hoy
                  </Typography>
                  <Typography variant="body2" sx={{ fontWeight: 500 }}>
                    156
                  </Typography>
                </Box>
                
                <Box sx={{ display: 'flex', justifyContent: 'space-between' }}>
                  <Typography variant="body2" color="text.secondary">
                    Tiempo de Respuesta
                  </Typography>
                  <Typography variant="body2" sx={{ fontWeight: 500 }}>
                    120ms
                  </Typography>
                </Box>
              </Box>

              <Box sx={{ mt: 4 }}>
                <Button
                  variant="outlined"
                  fullWidth
                  startIcon={<Info />}
                >
                  Ver Reporte Completo
                </Button>
              </Box>
            </CardContent>
          </Card>
        </Grid>
      </Grid>

      {/* Configuraciones por categoría */}
      <Box sx={{ mt: 4 }}>
        <Grid container spacing={3}>
          {configuraciones.map((config, index) => (
            <Grid item xs={12} md={6} key={index}>
              <Card sx={{ backgroundColor: '#1e293b', border: '1px solid #334155' }}>
                <CardContent>
                  <Box sx={{ display: 'flex', alignItems: 'center', gap: 2, mb: 3 }}>
                    <Box sx={{ color: 'primary.main' }}>
                      {config.icono}
                    </Box>
                    <Typography variant="h6" sx={{ fontWeight: 600 }}>
                      {config.categoria}
                    </Typography>
                  </Box>
                  
                  <List sx={{ py: 0 }}>
                    {config.items.map((item, itemIndex) => (
                      <React.Fragment key={itemIndex}>
                        <ListItem
                          button
                          sx={{
                            px: 0,
                            py: 1,
                            borderRadius: 1,
                            '&:hover': {
                              backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            },
                          }}
                        >
                          <ListItemText
                            primary={item.nombre}
                            secondary={item.descripcion}
                            primaryTypographyProps={{
                              variant: 'body2',
                              sx: { fontWeight: 500 },
                            }}
                            secondaryTypographyProps={{
                              variant: 'caption',
                              sx: { color: 'text.secondary' },
                            }}
                          />
                        </ListItem>
                        {itemIndex < config.items.length - 1 && (
                          <Divider sx={{ my: 1 }} />
                        )}
                      </React.Fragment>
                    ))}
                  </List>
                </CardContent>
              </Card>
            </Grid>
          ))}
        </Grid>
      </Box>

      {/* Pie de página */}
      <Box sx={{ mt: 4, textAlign: 'center' }}>
        <Typography variant="body2" color="text.secondary">
          Sistema de Gestión de Usuarios v1.0.0 - Desarrollado con Spring Boot y React
        </Typography>
      </Box>
    </Container>
  );
};

export default Configuracion;